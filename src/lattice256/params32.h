/**********************************************************************
    CIP_SIS (Confidential Integer Processing)
    Copyright (C) 2022  Jayamine Alupotha

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */


#ifndef ZKSC_PARAMS32_H
#define ZKSC_PARAMS32_H

#include <boost/multiprecision/cpp_int.hpp>

using namespace boost::multiprecision;

typedef int256_t zint_t;
typedef uint256_t zuint_t;
typedef int512_t zint2_t;

#define L       32

#define N       256
#define n       5
#define mk      1
#define mv      1
#define mr      1
#define m       (mk + mv + mr)
#define D       (mv + mr)

#define K1      165
#define K11     164
#define K2      38
#define KMONT   167

#define GAMMA2_BITS  90
#define GAMMA1_BITS  86
#define ALPHA_BITS   11
#define TAU_BITS     7
#define TAU1_BITS    7
#define TAU2_BITS    28
#define TAU3_BITS    20

#define u_BYTES       ((K1 * N)/8)  // 1600
#define z_BYTES       (L*((ALPHA_BITS + 1) * N)/8)
#define R_BYTES       ((m - D) * ((TAU2_BITS + 1) * N)/8)
#define sig_BYTES     ((m - D) * ((TAU3_BITS + 1 + 1) * N)/8) // for two 17 bits

#define r_BYTES       ((N)/8 * (TAU_BITS + 1))
#define r1_BYTES      ((N)/8 * (TAU1_BITS + 1))
#define r2_BYTES      ((N)/8 * (TAU2_BITS + 1))
#define r3_BYTES      ((N)/8 * (TAU3_BITS + 1))
#define a_BYTES       ((N)/8 * (ALPHA_BITS + 1))

#define BETA           60  // number of +1 or -1 in the challenge polynomial
#define SEED_BYTES     32
#define CRH_BYTES      64

#define CHI            64

#define u_ERROR        (86 - 32)
#define u_chal_ERROR   86
#define t1_ERROR       (86 - 10)
#define t2_ERROR       (86 - 10)
#define t3_ERROR       86
#define pk_ERROR       u_ERROR
#define y_ERROR        86
#define aggr_ERROR     86

#define u_HIGHBITS        ((((K11 - u_ERROR + 1) * N)/8) * n)
#define u_chal_HIGHBITS   ((((K11 - u_chal_ERROR + 1) * N)/8) * n)
#define t1_HIGHBITS       ((((K11 - t1_ERROR + 1) * N)/8) * n)
#define t2_HIGHBITS       ((((K11 - t2_ERROR + 1) * N)/8) * n)
#define pk_HIGHBITS       ((((K11 - pk_ERROR + 1) * N)/8) * n)
#define y_HIGHBITS        ((((K11 - y_ERROR + 1) * N)/8) * n)
#define aggr_HIGHBITS    ((((K11 - aggr_ERROR + 1) * N)/8) * n)

#define HINTBITS       2
#define HINTBYTES      ((((HINTBITS) * N)/8) * n)

#define EXTRA_BITS  8

static const int256_t Q("46768052394588893382517914646921056628714963468289");
static const int256_t Q2("23384026197294446691258957323460528314357481734144");
// Zp = Integers(Q), min(Zp.zeta(N*2, all=True))
static const int256_t ROOT("92254331596159226941262752792244772216041349194");
// R = 2**KMONT
static const int256_t R("187072209578355573530071658587684226515959365500928");
// MONT = R in [0, Q]
static const int256_t MONT("1099511627772");
// inverse_mod(Q, R)
static const int256_t QINV("140309866174537524756265411299509345715689573318657");
// R - 1
static const int256_t FILTER("187072209578355573530071658587684226515959365500927");
// MONT^2/256 (MONT*MONT*inverse_mod(256, Q))% Q
static const int256_t F1("43845049119927087546110544986210857072255563726849");
// MONT/256  (MONT*inverse_mod(256, Q))% Q
static const int256_t F2("730750818665451459101842416358141509827966271488");

//static const zint_t MAX("4294967296"); // 2**32

static const zint_t GAMMA2("1237940039285380274899124224"); // 2**90
static const zint_t GAMMA1("77371252455336267181195264"); // 2**86
static const zint_t ALPHA("2048"); // 2**11
static const zint_t TAU("128");
static const zint_t TAU1("128");
static const zint_t TAU2("268435456");
static const zint_t TAU3("1048576");

// Safe range for different operations
static const zint_t SR_RP_z(ALPHA - 1);
static const zint_t SR_RP_s(TAU2 - (BETA * TAU) - (BETA * BETA * TAU1));
//static const zint_t SR_MUL_z(ALPHA1 - MAX);
static const zint_t SR_MUL_s(TAU2 - (3 * BETA * BETA * TAU) - BETA * TAU1);
//static const zint_t SR_DIV_z(ALPHA1 - MAX);
static const zint_t SR_DIV_s(TAU2 - (4 * BETA * BETA * TAU) - BETA * TAU1);
static const zint_t SR_EQ_s(TAU3 - (2 * BETA * TAU));

// zeta_0 = (2^23 * root^(128)) mod q => 128 = bit_rev(0) index(1)
// zeta_1 = (2^23 * root^(129)) mod q => 129 = bit_rev(1) index()
// zeta_2 = (2^23 * root^(65)) mod q => 65 = bit_rev(2)
// 17592186044415 (index(0))
static const zint_t zetas[N] = {(int256_t)("1099511627772"),
                                (int256_t)("20060955385836352613545413881292279647683680560863"),
                                (int256_t)("-3521590350572457064944868409604380542471210080405"),
                                (int256_t)("19619225426818735634327517675192223640709985792915"),
                                (int256_t)("21812787494564262216819703608071944578376526892475"),
                                (int256_t)("18073463038469527866163096937032523467496569081951"),
                                (int256_t)("17375610757780395795084882662708643070034746222425"),
                                (int256_t)("-13534869736646608173061720448645897200372022957746"),
                                (int256_t)("-5130735222767615039741687866038146369332115370510"),
                                (int256_t)("14082267988033219416172634182136665524572742258159"),
                                (int256_t)("9922344311123661347094144139680984477825542149209"),
                                (int256_t)("-12951869495143141575216193050311505598812883829398"),
                                (int256_t)("17290490738227637967093327415163534496728107206459"),
                                (int256_t)("-8193949567808810241790074673810550326520955149865"),
                                (int256_t)("22882161273139209721580495586520769060317033076565"),
                                (int256_t)("-18079355110117557302433289599255350936253915148408"),
                                (int256_t)("-11892302131091457070501865809580661633379861984306"),
                                (int256_t)("-11785989808653301818036936437903319266496401704846"),
                                (int256_t)("-7301029223950218627799553882467477717959893926405"),
                                (int256_t)("-4629665384289757061344841718637340085455823551671"),
                                (int256_t)("-18906671714590355936251640189778571435932369209018"),
                                (int256_t)("10415179431755316593858255587649966403042692916877"),
                                (int256_t)("-13348473012364034088117233009644471445953391432603"),
                                (int256_t)("14817651265315998046576274117649813274931498352198"),
                                (int256_t)("21051415316071207630483278251665096632923187995978"),
                                (int256_t)("-7134506908208743277851862581807768896481568479780"),
                                (int256_t)("-2995042276552945314684633958408299528983441237418"),
                                (int256_t)("19667451066548004506319039759976774902066266787476"),
                                (int256_t)("3465178859014298974012979732153166718281104267588"),
                                (int256_t)("9886824227658024962979392457193604721075021996740"),
                                (int256_t)("-3350002093811981129649529970787490210920640937961"),
                                (int256_t)("17326439162208669989957636428030503915969088606391"),
                                (int256_t)("-9300672648207807875004567504696583946745972677381"),
                                (int256_t)("-471845353482365575947267727314653187286661325679"),
                                (int256_t)("742416251022398361180904332528123705957024930401"),
                                (int256_t)("-19468478032798345898169123340156011009818880526728"),
                                (int256_t)("-6288941138624520732690168618441602683272159988842"),
                                (int256_t)("1096680208671665531749554754919078555815681344909"),
                                (int256_t)("15665419684352847319551692065528026881199623249360"),
                                (int256_t)("16066243332605293378919561100837337413794814344643"),
                                (int256_t)("-15690264908512087337573081467971410210576861776270"),
                                (int256_t)("23047351015409339779324816799801540241543756163571"),
                                (int256_t)("5125118816188295154129069377920806063639487433005"),
                                (int256_t)("-20799438174506672332666054643890985194067086258103"),
                                (int256_t)("-1329762903473485847026762079597007357589363509485"),
                                (int256_t)("-9950421115574081517296476360250970523213768513370"),
                                (int256_t)("-8146888658627636619589103670797290217819051202921"),
                                (int256_t)("6671981749331826291396808278278073838690394083582"),
                                (int256_t)("16060998938350349368395401439131389274687108413244"),
                                (int256_t)("-10955517267843234480293408529153759636482660755951"),
                                (int256_t)("8851503731850038632271783645260815621948958958937"),
                                (int256_t)("11310724815896548510676634704467815988369792397296"),
                                (int256_t)("-10610554451496864098151459557040510931709038900612"),
                                (int256_t)("20700238628686386779879244104727658733016735898374"),
                                (int256_t)("-17965244055810821838347575093343035661906732163174"),
                                (int256_t)("6112250605547177303911364235360538613865812259356"),
                                (int256_t)("-23341338402247211380405288016417330842281815971113"),
                                (int256_t)("12664380844244472818479395008212887169096990132354"),
                                (int256_t)("-14793536556185908644309625351443212377778135188595"),
                                (int256_t)("17996881361272986763437943672478708748130604116263"),
                                (int256_t)("-8619257170074817051689238007596962833599226283093"),
                                (int256_t)("-2921761656922448333960804955725304793669646682353"),
                                (int256_t)("791374591872627809580214912340946242268041564616"),
                                (int256_t)("19647074849902749579857319184887029212900615724739"),
                                (int256_t)("-12985257552312685811241104732579052736373798157498"),
                                (int256_t)("10734070317181045220885647573481191940400122963063"),
                                (int256_t)("19592647511143373249110261747858205363485862470034"),
                                (int256_t)("15512178454863337639104352482988145651081268047011"),
                                (int256_t)("-4278611653175127803558083941544903367287741320199"),
                                (int256_t)("-23058599565209051940575807872633567983610326725718"),
                                (int256_t)("-5594508095263124817822377144711171050724479757636"),
                                (int256_t)("21405426222671824693445461576216440353264430657823"),
                                (int256_t)("-19936616425284545457513394804095950543678063238148"),
                                (int256_t)("-21266724717670135766507788472197945823601716795429"),
                                (int256_t)("-2882879795656953623340448811959395761229693166715"),
                                (int256_t)("3713320870213701213839752846815540445247091052234"),
                                (int256_t)("-20842790172444885773379544763378722864773182615684"),
                                (int256_t)("9008700429069707765082300075505297789071995214158"),
                                (int256_t)("20875223416779888165380684805952973572745117252683"),
                                (int256_t)("1034100636262591565126827679445309674754208823975"),
                                (int256_t)("-22587496023995777171176818103641137732839585721527"),
                                (int256_t)("-14830199349426619787482831310692795173773175517169"),
                                (int256_t)("-19611958570624255031452893326613767062891460724498"),
                                (int256_t)("-23140173238855210395027348235138883667076544037807"),
                                (int256_t)("7579464613158644458630893153943527170655523905982"),
                                (int256_t)("-13623971592248483260768590122939388970329606720904"),
                                (int256_t)("14356760544534872967709056692534366426923534916783"),
                                (int256_t)("-6782264601606859732041929691457163123370647192798"),
                                (int256_t)("-15367035857025652756206739570534150945456138473997"),
                                (int256_t)("12694446513030817233659584135233431198264168350231"),
                                (int256_t)("-14075122301758093174293684592390772202657518563167"),
                                (int256_t)("17127386741079725558239429657091264218416794497750"),
                                (int256_t)("480213042960423636972962760599106048053722479472"),
                                (int256_t)("-22645938276035722440666755556720924400076619994565"),
                                (int256_t)("-3683332243102970846047367758780409039254668753611"),
                                (int256_t)("13791718703108592677141831028975536311185249790866"),
                                (int256_t)("-1181420914241094713090626981771411161752380256131"),
                                (int256_t)("-16472589863697457330250308672170283578424680976918"),
                                (int256_t)("-20911369953494022790084173920563241325880927504819"),
                                (int256_t)("-1701629401271520252727236074098146669076048715103"),
                                (int256_t)("2051738824813691616599666014940994912991196709902"),
                                (int256_t)("-11242657722406929836709596672176568713459136238300"),
                                (int256_t)("21327008624608594996006223688485517714005125952686"),
                                (int256_t)("-19988907357682696084306691077031164417408894080610"),
                                (int256_t)("-14439059838660569212934122947116214038802462327404"),
                                (int256_t)("950363287667989564838910336308854814636190231988"),
                                (int256_t)("15015384241126723057672946484099622180245311962316"),
                                (int256_t)("-21283594618167945543570368621371716289313901167243"),
                                (int256_t)("-9946168909248123361180362873666994591906735709384"),
                                (int256_t)("-6718254602601621187142017540663426538836512028783"),
                                (int256_t)("-20944899852289259177906496834271547061890417930639"),
                                (int256_t)("-6519623859434270166673185363713602373612488554068"),
                                (int256_t)("2931824093214124519930248240292785062237398525636"),
                                (int256_t)("16480685602422783052729039718089959451119363573642"),
                                (int256_t)("-23016563105260175901051556798172792634382011551012"),
                                (int256_t)("-1986065865193722729076170366286217334500302903442"),
                                (int256_t)("4723299351394860595448041938895302344567052668672"),
                                (int256_t)("-15207484447217858650437029302415508062958668618533"),
                                (int256_t)("2067932307674094967818080638479653024809239655453"),
                                (int256_t)("4139269596887183273380768040090767240124551382863"),
                                (int256_t)("3431842044959778647617494585728910371045782677452"),
                                (int256_t)("7278406072110032308480853904132658797568630335565"),
                                (int256_t)("20849564985118093785077346551313158999254353811633"),
                                (int256_t)("-6071520804496351639068280099312907276572058242910"),
                                (int256_t)("-6725672104130452965104871910756510587337361001630"),
                                (int256_t)("5509464534156617223279597252642883545952566680797"),
                                (int256_t)("5840566893888036952433140355517755274465563403236"),
                                (int256_t)("-13744800902919818248998456935226804925895712674671"),
                                (int256_t)("-18916069492797207145832701671148058201218038964089"),
                                (int256_t)("5856603555563048598021985882440447654263357413145"),
                                (int256_t)("-17022914297234285321758973965776013708987629702426"),
                                (int256_t)("5638123274613561719960452867259860124017639099981"),
                                (int256_t)("-3105815554496244077739413837600738296680858890611"),
                                (int256_t)("-1426212556575132332441902528980475436494824390125"),
                                (int256_t)("22964414064616804016898240177033036045851803555892"),
                                (int256_t)("-19489887004770326095046331223761396162688236029311"),
                                (int256_t)("2706629321913613559253286989912874647696736759840"),
                                (int256_t)("-10482612006928005304873194609374583484754195904192"),
                                (int256_t)("-19026017985305936921492409168232490588769837117818"),
                                (int256_t)("2612800263129416976109070856074118312908345974673"),
                                (int256_t)("-8987362928130749428527627557944453419899882388645"),
                                (int256_t)("-13543765730126501930357419811131230878161034121158"),
                                (int256_t)("-19640861156796516210756527599714575566223725112545"),
                                (int256_t)("6069075104882842364211463159603306966337468589992"),
                                (int256_t)("-2901579413141109836264740738060887106954354990823"),
                                (int256_t)("-5173748354440089478101977039939879900930571851513"),
                                (int256_t)("-21743676969646199472307143058505480090435484734252"),
                                (int256_t)("-2882194639533169486574600308535589307844989576069"),
                                (int256_t)("16828110506434928074409936802670726249493415805971"),
                                (int256_t)("5343932299935279034176802913236300716893887917758"),
                                (int256_t)("-12642497963790915444535639752553205219428774955230"),
                                (int256_t)("9698181025918440977939453697756838507247434016839"),
                                (int256_t)("-17122410692763596287713756288691131462631496429838"),
                                (int256_t)("16396047709971394389563137447513483875571053992540"),
                                (int256_t)("13395426862416836465989281282154241737806564446403"),
                                (int256_t)("2862552585078234916289986246791442523970525278874"),
                                (int256_t)("7020992209730049456647544911895239602726025776270"),
                                (int256_t)("16697165340023908451645486531675395404980052105660"),
                                (int256_t)("-3404010024087368841699581037690346121971925309936"),
                                (int256_t)("-2975191756012014932827738825480330457852567705726"),
                                (int256_t)("517630509119377590354115418101762673218122118768"),
                                (int256_t)("3900052085984833626449266178337913490250585091628"),
                                (int256_t)("-1768367589742161956154778965615032976760394326380"),
                                (int256_t)("-7317930412951789181175928045283840781982799636064"),
                                (int256_t)("-15306347612583938861060807209988578413491359717925"),
                                (int256_t)("16612845127764410557336765197638369133806149248062"),
                                (int256_t)("11547061984755258918078556121930555858795883587087"),
                                (int256_t)("12215320267538525446718360598304957602965115744239"),
                                (int256_t)("-21338515297909080244664904585069399457888982788930"),
                                (int256_t)("19603744429188794401050982087937576781926222564338"),
                                (int256_t)("-1060340609278173969818722096504610709957440569903"),
                                (int256_t)("1560075166416772434115181830238130828438930918955"),
                                (int256_t)("-183256747833516225452018252281227164187855615946"),
                                (int256_t)("-2049714868684782808839316003800356873842918811170"),
                                (int256_t)("6209783753712740415131168168941281790471876932474"),
                                (int256_t)("-15710507350503821342372913140035407676584335267834"),
                                (int256_t)("-10387298590671756443197293481872933740347174041729"),
                                (int256_t)("-13532103296256444442578218581981940254352667515522"),
                                (int256_t)("10758595232225248955701514641135023155257088052375"),
                                (int256_t)("21214942628580011663451333857523086006795896257028"),
                                (int256_t)("567375493829484658097716119841339625603642799759"),
                                (int256_t)("-7373708601668652251248601783713014769062053348435"),
                                (int256_t)("-12079448900652321969173721912990643081559358145051"),
                                (int256_t)("12292785798189674281818310883361535468053293340984"),
                                (int256_t)("13598085755659447811436238072926202549357154970922"),
                                (int256_t)("17596897233201532410492449943491143650107462202990"),
                                (int256_t)("1323978181618802098259804792372671416939198939431"),
                                (int256_t)("-14891803695252589367420608247870992497553751663753"),
                                (int256_t)("6028263630278752055818057333814791745961412620016"),
                                (int256_t)("-2185011089071999003618664297394455775490742928273"),
                                (int256_t)("-7693030392773386870199361932435494390200887762502"),
                                (int256_t)("-6170271251073938679265330780987853795741195981004"),
                                (int256_t)("11994570504606515083540551179625665711280559696547"),
                                (int256_t)("-11149935229606401632958765313845609644966061033728"),
                                (int256_t)("17823945201188956463549438418193693937337663796376"),
                                (int256_t)("-14743447851051986552014767693634761848140374720506"),
                                (int256_t)("17584292264564637982881002436132693098254873567030"),
                                (int256_t)("-7280160474206130954980036444357788871299612495286"),
                                (int256_t)("-3816000381137678580417769631631888848371912375874"),
                                (int256_t)("-8427940735767459064619889988157816218080404347823"),
                                (int256_t)("20015181132468904887907769016556746928470879182376"),
                                (int256_t)("-15032049023646020306166364879934837023502596021281"),
                                (int256_t)("12848977651253605010364763685263819114867593154665"),
                                (int256_t)("-9456276832296786014604285971712853757966604981071"),
                                (int256_t)("-11487119494282603848752366776115600644454533573646"),
                                (int256_t)("-15635519874772982734069945553196855958354750831129"),
                                (int256_t)("17984528090404050046706784650342354633372523005261"),
                                (int256_t)("-21469832951679599104750371567600006813936361416445"),
                                (int256_t)("16151213923744137290417589786482159102570690568869"),
                                (int256_t)("12741101950596688494267440056054201061596200707727"),
                                (int256_t)("-13390293129815247369366559444201414041342672657365"),
                                (int256_t)("10865567477141604793628219084703313110607600038063"),
                                (int256_t)("22780120433235178779840902363363754211304523672057"),
                                (int256_t)("20274818476051312412772551587420391726558633124801"),
                                (int256_t)("582928207741247764836206464393703897034348906646"),
                                (int256_t)("7995238964205349279265228322180558453554834085546"),
                                (int256_t)("9148542041927138006317719688269809133093982656326"),
                                (int256_t)("-4738411430473531555390917685023648396896947390068"),
                                (int256_t)("-10806345636188164995455306541831670306526433128046"),
                                (int256_t)("-7411786617431304003075299945895653419405429789858"),
                                (int256_t)("-2796876179068304909411249084312429787657883299359"),
                                (int256_t)("8603902109086747901481021164315860662779708687799"),
                                (int256_t)("-15646772971071658672499194891484463162067887612125"),
                                (int256_t)("-17313542935593437165672479116016863513435174512895"),
                                (int256_t)("-21421987248757295217411268351990272523127365218040"),
                                (int256_t)("-21487378309713822339669650170197718287752669861544"),
                                (int256_t)("-18884950952338164332990674914775521353191907394529"),
                                (int256_t)("16759336759539956052352121690810139540363792305624"),
                                (int256_t)("-8036258271704912819353760494103575850539398742336"),
                                (int256_t)("-15970678237461902560566839334054526645017905210707"),
                                (int256_t)("-20064116990352058524698288726738430933574897988489"),
                                (int256_t)("17008367367420951031666086295043402210279981194684"),
                                (int256_t)("-15983672927523051689450737426597637506996814298064"),
                                (int256_t)("-1211448913809761685559755486920016040982466351838"),
                                (int256_t)("-994993413304068721498355336148982021090927991509"),
                                (int256_t)("3712484782703072368404276266204137920548336710121"),
                                (int256_t)("11076937515872598505692909930083066005182877911675"),
                                (int256_t)("11060573304134005868330211551762409676370558114707"),
                                (int256_t)("12382688637551872100326043365927344996136551199431"),
                                (int256_t)("-18801063305096330111022350027075336093276215088998"),
                                (int256_t)("-6891863606786442647264736363177747745048422826575"),
                                (int256_t)("-10147584598388994464365363695243603243800383699544"),
                                (int256_t)("-14538609676384202054762177274795059567663118017688"),
                                (int256_t)("923103644597550375261357898833474682218684084304"),
                                (int256_t)("13329919987003986466887548632249976875851602452647"),
                                (int256_t)("-11672946989539697371441728288667531470009220557831"),
                                (int256_t)("5895191149464919643324521039936374634029737004195"),
                                (int256_t)("22521132007084751155623877529327166765856729536779"),
                                (int256_t)("-1542531786686147669973812510353263014200530225138"),
                                (int256_t)("10870729683540374016543137609301754105412813382378"),
                                (int256_t)("-13292353127891253430627355848372776906705319026211"),
                                (int256_t)("-9758058833492550394682894821556877627774061313619"),
                                (int256_t)("17958730496585472276283145791440464498687407678396"),
                                (int256_t)("15022158115010765503044013315329937564233933050042"),
                                (int256_t)("12597602420625479730183289760351496150553024405204"),
                                (int256_t)("20366261253554350423825232272799398211089493416351")
};
#endif //ZKSC_PARAMS32_H
